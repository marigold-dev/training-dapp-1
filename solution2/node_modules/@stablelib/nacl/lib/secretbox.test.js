"use strict";
// Copyright (C) 2016 Dmitry Chestnykh
// MIT License. See LICENSE file for details.
Object.defineProperty(exports, "__esModule", { value: true });
var secretbox_1 = require("./secretbox");
var hex_1 = require("@stablelib/hex");
describe("secretBox", function () {
    var key = new Uint8Array(32);
    for (var i = 0; i < key.length; i++) {
        key[i] = 1;
    }
    var nonce = new Uint8Array(24);
    for (var i = 0; i < nonce.length; i++) {
        nonce[i] = 2;
    }
    var data = new Uint8Array(64);
    for (var i = 0; i < data.length; i++) {
        data[i] = 3;
    }
    var good = "8442bc313f4626f1359e3b50122b6ce6fe66ddfe7d39d14e637eb4fd5b45beadab55198" +
        "df6ab5368439792a23c87db70acb6156dc5ef957ac04f6276cf6093b84be77ff0849cc" +
        "33e34b7254d5a8f65ad";
    it("should generate correct secretbox", function () {
        expect(hex_1.encode(secretbox_1.secretBox(key, nonce, data), true)).toBe(good);
    });
    it("should open secretbox", function () {
        var result = secretbox_1.openSecretBox(key, nonce, hex_1.decode(good));
        expect(result).not.toBeNull();
        expect(result).toEqual(data);
    });
    it("should not open invalid secretbox", function () {
        var bad = hex_1.decode(good);
        bad[50] = 0;
        expect(secretbox_1.openSecretBox(key, nonce, bad)).toBeNull();
    });
});
//# sourceMappingURL=secretbox.test.js.map